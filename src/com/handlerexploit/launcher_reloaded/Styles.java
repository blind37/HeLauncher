/* 
 * This program is free software. It comes without any warranty, to
 * the extent permitted by applicable law. You can redistribute it
 * and/or modify it under the terms of the Do What The Fuck You Want
 * To Public License, Version 2, as published by Sam Hocevar. See
 * http://sam.zoy.org/wtfpl/COPYING for more details.
 */

package com.handlerexploit.launcher_reloaded;

import java.io.IOException;

import android.app.Activity;
import android.app.WallpaperManager;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.Gallery;

public class Styles extends Activity {
	private Gallery mGallery;
	private WallpaperManager mWallpaperManager;
	private boolean setWallpapers = true;

    @Override
    public void onCreate(Bundle icicle) {
        super.onCreate(icicle);
        setContentView(R.layout.styles_main);
        
        mGallery = (Gallery) findViewById(R.id.gallery);
        mGallery.setAdapter(new StylesAdapter(this));
        
        Button button = (Button)findViewById(R.id.apply);
        button.setOnClickListener(mApplyClicked);
    }
    
    private final OnClickListener mApplyClicked = new OnClickListener() {
        public void onClick(View v) {
        	SharedPreferences sp = Styles.this.getSharedPreferences(Launcher.STYLE_PREF, 0);
        	Editor editor = sp.edit();
            int selectedPos = mGallery.getSelectedItemPosition();
            String pref = Launcher.PREFERENCE_STYLE;
            switch (selectedPos) {
            case 0:
            	if (setWallpapers)
            		setWallpaper(R.drawable.htc_wallpaper_14);
            	editor.putInt(pref , 0);
            	editor.commit();
            	break;
            case 1:
            	if (setWallpapers)
            		setWallpaper(R.drawable.htc_wallpaper_02);
            	editor.putInt(pref , 1);
            	editor.commit();
            	break;
            case 2:
            	if (setWallpapers)
            		setWallpaper(R.drawable.htc_wallpaper_01);
            	editor.putInt(pref , 2);
            	editor.commit();
            	break;
            case 3:
            	if (setWallpapers)
            		setWallpaper(R.drawable.htc_wallpaper_10);
            	editor.putInt(pref , 3);
            	editor.commit();
            	break;
            case 4:
            	if (setWallpapers)
            		setWallpaper(R.drawable.htc_wallpaper_07);
            	editor.putInt(pref , 4);
            	editor.commit();
            	break;
            case 5:
            	if (setWallpapers)
            		setWallpaper(R.drawable.htc_wallpaper_12);
            	editor.putInt(pref , 5);
            	editor.commit();
            	break;
            }
            finish();
        }
    };
    
    private void setWallpaper(int i) {
        mWallpaperManager = WallpaperManager.getInstance(this);
        
        try {
			mWallpaperManager.setResource(i);
		} catch (IOException e) {
			//Ignore
		}
    }
}